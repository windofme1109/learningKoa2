## Express中间件的原理及其实现

### 1. 中间件的使用

1. 通过`app.use([path], function)`调用。path参数可选，如果没有path，就对所以的请求path应用这个中间件。

2. 在路由处理中使用。`router.METHOD(path, [callback, ...] callback)`。最后一个回调是处理函数。中间的回调函数就是中间件，以从左向右，依次进行调用。

### 2. 中间件的调用顺序

- express中，中间件是按照先后顺序进行调用。即从上到下，依次调用。

### 3. 中间件分析

1. app.use()用来注册中间件，先收集起来
   - 通过app.use()注册一个中间件。那么这些中间件会按照顺序被收集起来，等待被调用。

2. 遇到http请求，根据path和method判断触发哪些

3. 实现next机制，上一个通过next触发下一个